# Copy to app/assets/env/.env for local development
FLAVOR=dev
API_BASE_URL=http://localhost:5001
API_SSL_VERIFY=true

EVENTS_WS_URL=wss://localhost:5002/events/media
WS_RETRY_INTERVAL_MS=3000
WS_RETRY_ACTIVE_SECONDS=60
WS_RETRY_COOLDOWN_SECONDS=60
WS_RETRY_MAX_TOTAL_SECONDS=1800
EVENTS_WS_SSL_VERIFY=true

SPOTIFY_POLL_INTERVAL_SEC=3
# SONOS_POLL_INTERVAL_SEC=10  # Optional; unset means default server/SDK interval
MAX_AVATARS_PER_USER=6

WS_RETRY_INTERVAL_MS=3000
WS_RETRY_ACTIVE_SECONDS=60
WS_RETRY_COOLDOWN_SECONDS=180
WS_RETRY_MAX_TOTAL_SECONDS=1800
WS_FORCE_RECONN_IDLE_SEC=300

# Direct Spotify polling configuration
SPOTIFY_DIRECT_API_BASE_URL=https://api.spotify.com/v1
SPOTIFY_DIRECT_POLL_INTERVAL_SEC=3
SPOTIFY_DIRECT_RETRY_INTERVAL_SEC=3
SPOTIFY_DIRECT_RETRY_WINDOW_SEC=10
SPOTIFY_DIRECT_COOLDOWN_SEC=30
SPOTIFY_DIRECT_API_SSL_VERIFY=true

# =============================================================================
# Service Priority Configuration
# =============================================================================

# Priority order of services (comma-separated)
# Options: direct_spotify, cloud_spotify, cloud_sonos
# First service in list = primary, subsequent = fallbacks in order
# Services are filtered by user settings (Spotify/Sonos enabled)
PRIORITY_ORDER_OF_SERVICES=direct_spotify,cloud_spotify,cloud_sonos

# Direct Spotify Fallback Configuration
# Triggers fallback when direct Spotify polling fails
SPOTIFY_DIRECT_FALLBACK_TIMEOUT_SEC=5
SPOTIFY_DIRECT_FALLBACK_ON_ERROR=true
SPOTIFY_DIRECT_FALLBACK_ERROR_THRESHOLD=3

# Direct Spotify Retry Configuration (when on fallback, retry primary)
SPOTIFY_DIRECT_RETRY_INTERVAL_SEC=10
SPOTIFY_DIRECT_RETRY_COOLDOWN_SEC=30
SPOTIFY_DIRECT_RETRY_MAX_WINDOW_SEC=300

# Cloud Spotify (WebSocket) Fallback Configuration
# Backend polls Spotify API at regular intervals, so timeout is enabled
CLOUD_SPOTIFY_FALLBACK_TIMEOUT_SEC=5
CLOUD_SPOTIFY_FALLBACK_ON_ERROR=true
CLOUD_SPOTIFY_FALLBACK_ERROR_THRESHOLD=3

# Cloud Spotify Retry Configuration
CLOUD_SPOTIFY_RETRY_INTERVAL_SEC=10
CLOUD_SPOTIFY_RETRY_COOLDOWN_SEC=30
CLOUD_SPOTIFY_RETRY_MAX_WINDOW_SEC=300

# Cloud Sonos (WebSocket) Fallback Configuration
# NOTE: Sonos is EVENT-DRIVEN (only emits on state change), so timeout is DISABLED (0)
# Fallback for Sonos relies on WebSocket connection errors, not data timeout
CLOUD_SONOS_FALLBACK_TIMEOUT_SEC=0
CLOUD_SONOS_FALLBACK_ON_ERROR=true
CLOUD_SONOS_FALLBACK_ERROR_THRESHOLD=3

# Cloud Sonos Retry Configuration
CLOUD_SONOS_RETRY_INTERVAL_SEC=10
CLOUD_SONOS_RETRY_COOLDOWN_SEC=30
CLOUD_SONOS_RETRY_MAX_WINDOW_SEC=300

# Global Service Settings
# Grace period during service transitions to avoid UI flicker
SERVICE_TRANSITION_GRACE_SEC=2
# Max time to wait for token before fallback
TOKEN_WAIT_TIMEOUT_SEC=10
